---
title: "Modeling approaches for cross-sectional integrative data analysis"
subtitle: "Evaluations and recommendations"
author: "Kenneth Tyler Wilcox & Lijuan Wang"
institute: "Department of Psychology, University of Notre Dame"
date: "IMPS, 21 July 2021"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    self_contained: false # if true, fonts will be stored locally
    lib_dir: libs
    chakra: libs/remark-latest.min.js # Use offline
    nature:
      slideNumberFormat: "%current%"
      beforeInit: "macros.js"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
here::i_am("wilcox-wang-imps2021.Rmd")
options(htmltools.dir.version = FALSE) # Default in xaringanthemer template; don't know what this does
knitr::opts_chunk$set(
  fig.width = 8, fig.height = 4.5, fig.retina = 2, # fig.retina = 2 for most Retina displays (https://yihui.org/knitr/options/#plots)
  dpi = 300,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE
)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(latex2exp)
library(rlang)
library(stringr)
library(purrr)
library(readr)
library(dplyr)
library(ggplot2)
library(xaringanthemer)
library(here)

# Color codes from Nord theme: https://www.nordtheme.com
style_mono_light(
  base_color       = "#2E3440",
  header_font_google  = google_font("Fira Sans", "400"),
  # header_font_google  = google_font("Roboto", "400"),
  header_h1_font_size = "2.25rem",
  header_h2_font_size = "1.5rem",
  header_h3_font_size = "1.25rem",
  # text_font_google    = google_font("Fira Sans", "300", "300i"),
  text_font_google    = google_font("Roboto", "300", "300i"),
  text_font_size      = "1.25rem", 
  code_font_google    = google_font("Fira Code Retina"),
  header_background_auto = TRUE,
  # title_slide_background_image = "figures/",
  title_slide_background_size = "50%",
  title_slide_background_position = "50% 95%",
  title_slide_background_color = "#ECEFF4", # white
  title_slide_text_color = "#2E3440"
)
options(crayon.enabled = TRUE)
```

class: inverse center middle

# What is Integrative Data Analysis?

## Advantages

## Current Practice

---

# Integrative Data Analysis (IDA)

> Integrative data analysis (IDA) simultaneously analyzes the *participant-level* data from multiple studies (Curran & Hussong, 2009)

--

+ Also known as
  + individual participant meta-analysis (Cooper & Patall, 2009)
  + individual patient data meta-analysis (Stewart & Tierney, 2002)
  + mega-analysis (McArdle et al., 2009)
  + data fusion (Marcoulides & Grimm, 2017)

---

# Advantages of IDA

.footnote[(Bauer & Hussong, 2009; Curran et al., 2018; Curran &
Hussong, 2009; Marcoulides & Grimm, 2017; McArdle et al.,
2009; Stewart & Tierney, 2002)]

--

+ Directly assess the replicability of effects across studies and populations

--

+ Use of multiple samples introduces and allows modeling of between-sample heterogeneity

--

+ Can fit more complex models and answer new research questions

--

+ Longitudinal analysis of longer timespans is often possible

--

+ Improved harmonic measurements

???

+ Point 2: resulting in better external validity than a single study and an understanding
of the sources of between-study heterogeneity

---

class: inverse center middle

# Five IDA Models

## Aggregated Regression

## Disaggregated Regression

## Study-Specific Coefficients Regression

## Fixed Slope Multilevel Model

## Random Slopes Multilevel Model

---

# Regression and Disaggregation

class: center middle

--

.pull-left[
## Aggregated Regression

$$\begin{split} y_{ij} &= \gamma_{00} + \gamma_A x_{ij} + e_{ij} \\
    e_{ij} &\sim \text{N} \left(0, \sigma^2_e \right)
  \end{split}$$
]

--

.pull-right[
## Disaggregated Regression

$$\begin{split}
    y_{ij} &= \gamma_{00}^{*} + \gamma_B \bar{x}_j + \gamma_W \left( x_{ij} - \bar{x}_j \right) + e_{ij} \\
    e_{ij} &\sim \text{N} \left(0, \sigma^2_e \right)
  \end{split}$$
]

---

# Regression and Mean Heterogeneity

--

## Study-Specific Coefficients Regression

--

\begin{equation}
  \begin{split}
    y_{ij} &= \sum_{k=1}^J \gamma_{0k} I(k = j) + \gamma_W x_{ij} + e_{ij} \\
    e_{ij} &\sim \text{N} \left(0, \sigma^2_e \right)
  \end{split}
  \label{eq:fixed-ssc}
\end{equation}

---

# Multilevel Models

## Fixed Slope Multilevel Model

--

+ Extend the disaggregated regression model to incorporate between-study heterogeneity

--

\begin{equation}
  \begin{split}
    \text{Level 1: } y_{ij} &= \beta_{0j} +
                               \beta_{1j} \left( x_{ij} - \bar{x}_j \right) +
                               e_{ij} \\
    \text{Level 2: } \beta_{0j} &= \gamma_{00} + \gamma_{B} \bar{x}_j + u_{0j} \\
                     \beta_{1j} &= \gamma_{W} \\
                     \begin{bmatrix} \vec{e}_{j} \\ u_{0j} \end{bmatrix} &\sim \text{N}\left( \begin{bmatrix} \vec{0} \\ 0 \end{bmatrix}, \begin{bmatrix} \sigma^2_e \vec{I}_{n_j} & 0 \\ 0 & \sigma^2_{u_0} \end{bmatrix} \right)
  \end{split}
  \label{eq:fixed}
\end{equation}

---

## Random Slopes Multilevel Model

--

+ Extend the disaggregated regression model to incorporate between-study heterogeneity

--

\begin{equation}
  \begin{split}
    \text{Level 1: } y_{ij} &= \beta_{0j} +
                               \beta_{1j} \left( x_{ij} - \bar{x}_j \right) +
                               e_{ij} \\
    \text{Level 2: } \beta_{0j} &= \gamma_{00} + \gamma_{B} \bar{x}_j + u_{0j} \\
                     \beta_{1j} &= \gamma_{W} + u_{1j} \\
                     \begin{bmatrix} \vec{e}_{j} \\ u_{0j} \\ u_{1j} \end{bmatrix} &\sim \text{N}\left( \begin{bmatrix} \vec{0} \\ 0 \\ 0 \end{bmatrix}, \begin{bmatrix} \sigma^2_e \vec{I}_{n_j} & 0 & 0 \\ 0 & \sigma^2_{u_0} & \sigma_{u_{01}} \\ 0 & \sigma_{u_{01}} & \sigma^2_{u_1} \end{bmatrix} \right)
  \end{split}
  \label{eq:random}
\end{equation}

---

class: inverse center middle

# Research Questions

## Simulation Design

## RQ1

## RQ2

## RQ3

---

class: inverse center middle

# Recommendations

---

# Recommendations

+ Don't use ALR

+ FE models don't control type I error rate for either fixed effect with heterogeneity

+ RS MLM can yield well-controlled type I error rates for both fixed effects with appropriate DDFM even in small samples

---

# Conclusions

+ Carefully consider the assumptions involved in any IDA model

+ Suggests consideration of methods like MLMs that directly account for this heterogeneity.

---

# References
